{"ast":null,"code":"import xlsxParser from 'xls-parser';\nimport { v4 as uuidv4 } from 'uuid';\nimport { from, map } from 'rxjs';\nimport * as i0 from \"@angular/core\";\nexport let ExcelService = /*#__PURE__*/(() => {\n  class ExcelService {\n    constructor() {}\n\n    parse(file) {\n      console.log('file: ', file.name);\n      return from(xlsxParser.onFileSelection(file)).pipe(map(data => {\n        const sheet = data[Object.keys(data)[0]];\n        const list = Object.entries(sheet).map(([key, value]) => this.mapEC(parseInt(key) + 1, value));\n        return list;\n      }));\n    }\n\n    mapEC(key, value) {\n      return {\n        id: uuidv4(),\n        position: key,\n        name: value['Name'],\n        count: parseInt(value['Count']),\n        package: value['Package'] || '',\n        category: value['Category'] || '',\n        description: value['Type'] || '',\n        link: value['Comments'] || ''\n      };\n    }\n\n  }\n\n  ExcelService.ɵfac = function ExcelService_Factory(t) {\n    return new (t || ExcelService)();\n  };\n\n  ExcelService.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n    token: ExcelService,\n    factory: ExcelService.ɵfac\n  });\n  return ExcelService;\n})();","map":null,"metadata":{},"sourceType":"module"}